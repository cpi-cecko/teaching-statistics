 1. Why simulations?
 2. Simulating the CLT
 3. Normal plots

 ***

  Често бихме желали да симулираме разни работи с R. Днес ще се научим да
  правим точно това. Като за начало ще започнем с централната гранична теорема
  (Central Limit Theorem). Тя гласи, че при определени условия, средното
  аритметично на голям брой независими случайни величини ще бъде приблизително
  нормално разпределено, независимо от разпределението на тези случайни
  величини. Естествено, тези случайни величини трябва да има дефинирано
  математическо очакване и стандартно отклонение.

  Математически изразено, ако имаме наблюденията Xi взети от популация със
  знайни математическо очакване (mu) и стандартно отклонение (sd), то
  стандартизираното средно:

                           mean(X) - mu
                          --------------
                           sd / sqrt(n)

  E приблизително нормално разпределено със средно mu и стандартно отклонение
  sd.

  Първият въпрос, на който трябва да си отговорим е - Какво представлява
  нормалното разпределение? Ами, то е непрекъснато разпределение, което е
  характерно за голям набор от случайни събития. Формата му е камбановидна и
  симетрична относно математическото очакване.

  Един вид, централната гранична теорема ни позволява да свеждаме
  математическите очаквания на голям брой независими случайни величини до
  нормално разпределение.

  Първата симулация, която ще направим, е свързана с биномно разпределение.
  Имаме n биномно разпределени случайни величини и искаме да апроксимираме
  сумата им чрез нормално разпределение. Ако S е биномна разпределена,
  нейното математическо очакване mu е равно на n*p, а стандартното ѝ
  отклонение sd е равно на n*p*q. Тогава, от по-горната формула следва, че
  случайната величина, която апроксимира математическото очакване на тези
  случайни величини, е нормално разпределена и се изчислява чрез следната
  формула:

                            S - n*p
                          -----------
                          sqrt(n*p*(1-p))

  Сега, нека симулираме това в R, за S биномно разпределена случайна величина
  с n=10 и p=0.25:

    > n=10; p=0.25
    > S = rbinom(1000, n, p) # Генерираме 1000 независими, биномно
    + разпределени случайни величини
    > X = (S - n*p) / sqrt(n*p*(1-p))

  Единственото, което ни остава е да нарисуваме разпределението им за да видим
  доколко то прилича на нормално разпределение:
  
    > hist(X, prob=T, col="cadetblue3")
    > curve(dnorm(x), add=T)

  Виждаме, че получената хистограма доста се приближава до теоретичната
  плътност на нормалното разпределение.

  Централната гранична теорема работи също и за нормално разпределени данни. 
