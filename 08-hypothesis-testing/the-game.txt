 1. Какво е тестване на хипотеза?
 2. Тестване на популационно средно
 3. Тестване на разлика между две популационни средни
 4. Тестване на пропорция от биномно разпределение
 5. Тестване на разлика между пропорции от биномно разпределение

 ***

  Дотук задачата ни бе да разберем какви са характеристиките на дадена
  популация на базата на някаква извадка от тази популация.  Например, предния
  път разбрахме за колко време средно СУСИ отговаря на заявка за взимане на
  избираеми дисциплини.  Сега бихме искали да разберем дали, спрямо нашата
  извадка, дадена хипотеза за характеристиките на популацията е вярна.

  Например, бихме искали да разберем дали средното време за отговор на заявка
  от СУСИ е повече от 3.7 секунди.  За да си отговорим на тоя въпрос трябва да
  отхвърлим едно от две твърдения:

    1. Средното време за отговор е 3.7 секунди или по-малко
    2. Средното време за отговор е повече от 3.7 секунди

  Ако отхвърлим първото твърдение, значи че хипотезата ни, че СУСИ отговаря на
  заявка за повече от 3.7 секунди, е вярнa.

  Ако отхвърлим второто твърдение, значи че СУСИ отговаря на заявка за 3.7
  секунди или по-малко.

  Тези две твърдения се наричат хипотези.  Първото твърдение се нарича нулева
  хипотеза и обозначава твърдението, което желаем да опровергаем.  Второто 
  твърдение се нарича алтернативна хипотеза и обозначава твърдението, което
  желаем да приемем.

  Нека ги означим по този начин:

    H_0: mu <= 3.7
    H_A: mu > 3.7

  Това са нашите хипотези.  За да решим коя от двете да отхвърлим, е нужно да
  съберем данни.  Нека използваме данните от предишния урок.  Там имахме 100
  замервания със средно 5.7 и стандартно отклонение 8.5.  Извадъчното средно
  на тези замервания се нарича тест-статистика, защото то ни дава някаква
  статистическа оценка на нашите данни.  Това, което искаме да разберем е,
  доколко е вероятно нулевата ни хипотеза да е истина, спрямо тази тест
  статистика.  Благодарение на ЦГТ, можем да видим на колко стандартни
  отклонения лежи извадъчното средно спрямо предположеното популационно средно
  в нулевата хипотеза:

                            mean(X) - 3.7
                      z = ----------------- = 2.34
                           sd(X) / sqrt(n)

  Според нашите измервания, ако mu наистина е 3.7 или по-малко, вероятността
  да сме наблюдавали извадъчното средно 5.5 ще е много малка.  Поради тази
  причина можем да отхвърлим H_0 в полза на H_A.  Всъщност, нека видим каква е
  вероятността да наблюдаваме извадъчно средно 5.5, ако mu е 3.7:

    > pnorm(2.34, lower.tail=F)
    > 0.00964187

  Тази вероятност ни казва, че има около 0.01 вероятност да сме наблюдавали
  извадъчното средно 5.5, ако популационното средно е 3.7 или по-малко  Това
  ще рече, че имаме 0.01 вероятност за грешка в заключението си, защото все
  пак е възможно всичките 100 замервания на СУСИ, на базата на които го
  правим, да са някакъв частен случай, на който сме попаднали.  Тази вероятност
  на грешка се нарича грешка от първи род (Type I error) и се бележи с
  гръцката буква alpha.

  С тестването на хипотези можем да допуснем и друг тип грешка.  Този тип
  грешка показва вероятността да приемем нулевата хипотеза, когато някоя друга
  алтернативна хипотеза е вярна.  В този случай трябва да предположим коя
  друга алтернативна хипотеза може да е вярна и да видим каква е вероятността
  в този случай да приемем нулевата хипотеза.  Колкото по-малка е тази грешка,
  толкова по-добре за нас.

  Нека приемем, че в реалността средното време за отговор на СУСИ е 5 секунди
  и да изчислим, при това условие, каква е вероятността ни за грешка:

    H_0: mu = 3.7
    H_A: mu = 5.0

                P(приемаме H_0, когато H_A е вярна) =
                 P(приемаме H_0, когато mu = 5.0) =
          P(извадъчното средно да е в доверителния интервал за H_0)        (1)

  Доверителният интервал е: 3.7 +- 1.96*(8.5 / 10) = (2.03; 5.37)

  Трябва да видим каква е вероятността, ако реално средното време за заявка е
  5 секунди, то да попадне в доверителния интервал на H_0 и поради това
  погрешно да сме направили заключение, че реалното средно време за отговор е
  3.7 секунди:

    (1) = P(2.03 < |x < 5.37) = (след стандартизиране) P(-3.5 < |x < 0.44) =
          P(|x < 0.44) - P(|x < -3.5) = 0.67

  Както виждаме, тази вероятност е твърде голяма, за това е нужно да направим
  друго предположение за реалното средно време за отговор:

    H_0: mu = 3.7
    H_A: mu = 7.0

  Доверителният интервал си остава същия, защото го смятаме спрямо H_0, а H_0
  не се променя.  Единственото, което трябва да променим е стандартизираното
  средно:

    (1) = P(2.03 < |x < 5.37) = P(-5.85 < |x < -1.92) = 
          P(|x < -1.92) = 0.03

  Така вероятността да приемем H_0, при условие, че в реалността средното
  време за отговор е 7 секунди е 0.03, което ни устройва.  Вероятността за
  този тип грешка се бележи с гръцката буква beta и означава грешката от втори
  род (Type II error).  Стойността (1 - beta) се нарича сила на статистическия
  тест.  В случая 1 - beta = 0.97, което ще рече, че в 97 от 100 случая ние
  коректно ще отхвърлим H_0, при условие че mu наистина е равно на 7.0.

  Когато правим тестове на хипотези, целта ни е тези две грешки да са
  относително малки (под 0.1, например).  Грешката от първи род се смята
  лесно, защото можем да я фиксираме и да сравним p-value-то на теста с нея.
  Грешката от втори род, обаче, се базира на предположения за реалното средно
  и е нужно да отделим повече време и мисъл за да я пресметнем.  Некоректно е
  да се правят каквито и да било статистически заключения без да сме изчислили
  и двата типа грешки.

  С малко повече мозъчна активност (или пък липсата ѝ) бихме могли да прилжим
  тестването на хипотези и към други проблеми.  Например, искаме да видим дали
  след обновяването на СУСИ, заявките биват обработвани със средно 3 секунди
  по-бързо.  За целта, можем да установим следните хипотези:

    H_0: (mu1 - mu2) >= 3
    H_A: (mu1 - mu2)  < 3

  Където mu1 е средното време за отговор на СУСИ преди обновяването му, а mu2
  е средното време за отговор на СУСИ след обновяването му.

  В случая, тест-статистиката ни ще е:

                          (|x1 - |x2) - 3
                  z = ------------------------
                             s1^2     s2^2
                       sqrt(------ + ------)
                              n1       n2

  При положение, че имаме |x1, |x2, както и s1, s2, n1, n2, можем лесно да я
  сметнем.

    > source("../07-confidence-interval-estimation/susi.R")
    > x1 = mean(response_times)
    > x2 = mean(new_response_times)
    > s1 = sd(response_times)
    > s2 = sd(new_response_times)
    > n1 = length(response_times)
    > n2 = length(new_response_times)
    > d = 3
    > z = ((x1 - x2) - d) / sqrt(s1*s1 / n1 + s2*s2 / n2)
    > z
    [1] 2.561267
    > pnorm(z, lower.tail=F)
    [1] 0.005214553

  Виждаме, че p-value-то на тест-статистиката ни е доста по-малко от 0.01,
  което ще рече, че с високо ниво на доверие бихме могли да приемем
  алтернативната хипотеза.  Тоест, новото СУСИ е с поне 3 секунди по-бързо от
  старото.  Естествено, не бихме могли да направим никакво заключение преди да
  изчислим грешката ни от втори род.  Това забавление ще бъде оставено на
  перспективния читател.
